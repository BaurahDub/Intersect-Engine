From 6c4a47bffae22e0c1d21f484cfdadc7a913da417 Mon Sep 17 00:00:00 2001
From: lunarsourcellc <lunarsourcellc@gmail.com>
Date: Sat, 6 Jun 2020 21:49:50 -0400
Subject: [PATCH 11/11] Copy-Paste Fix

---
 .../GenericClasses/Clipboard.cs               |  3 +++
 .../Gwen/Control/MultilineTextBox.cs          |  8 +++----
 .../Gwen/Control/TextBox.cs                   |  8 +++----
 .../Intersect.Client.Framework.csproj         | 11 +++++++++
 Intersect.Client.Framework/app.config         | 23 +++++++------------
 Intersect.Client.Framework/packages.config    |  4 +++-
 Intersect.Tests.Client.Framework/app.config   | 23 +++++++------------
 Intersect.Tests.Client/app.config             |  2 +-
 8 files changed, 42 insertions(+), 40 deletions(-)

diff --git a/Intersect.Client.Framework/GenericClasses/Clipboard.cs b/Intersect.Client.Framework/GenericClasses/Clipboard.cs
index deaac26e..29123164 100644
--- a/Intersect.Client.Framework/GenericClasses/Clipboard.cs
+++ b/Intersect.Client.Framework/GenericClasses/Clipboard.cs
@@ -8,11 +8,13 @@ public static class Clipboard
 
         public static bool ContainsText()
         {
+            sValue = TextCopy.ClipboardService.GetText();
             return sValue != null;
         }
 
         public static string GetText()
         {
+
             if (ContainsText())
             {
                 return sValue;
@@ -24,6 +26,7 @@ public static string GetText()
         public static void SetText(string text)
         {
             sValue = text;
+            TextCopy.ClipboardService.SetText(text);
         }
 
     }
diff --git a/Intersect.Client.Framework/Gwen/Control/MultilineTextBox.cs b/Intersect.Client.Framework/Gwen/Control/MultilineTextBox.cs
index e4b09c14..0bc74f07 100644
--- a/Intersect.Client.Framework/Gwen/Control/MultilineTextBox.cs
+++ b/Intersect.Client.Framework/Gwen/Control/MultilineTextBox.cs
@@ -64,10 +64,10 @@ public MultilineTextBox(Base parent) : base(parent)
             //	This should be as simple as 'm_ScrollControl.AutoSizeToContents = true' or 'm_ScrollControl.NoBounds()'
             mScrollControl.SetInnerSize(1000, 1000);
 
-            AddAccelerator("Ctrl + C", OnCopy);
-            AddAccelerator("Ctrl + X", OnCut);
-            AddAccelerator("Ctrl + V", OnPaste);
-            AddAccelerator("Ctrl + A", OnSelectAll);
+            AddAccelerator("CTRL+C", OnCopy);
+            AddAccelerator("CTRL+X", OnCut);
+            AddAccelerator("CTRL+V", OnPaste);
+            AddAccelerator("CTRL+A", OnSelectAll);
         }
 
         private Point StartPoint
diff --git a/Intersect.Client.Framework/Gwen/Control/TextBox.cs b/Intersect.Client.Framework/Gwen/Control/TextBox.cs
index e27f5c5e..f83ca65b 100644
--- a/Intersect.Client.Framework/Gwen/Control/TextBox.cs
+++ b/Intersect.Client.Framework/Gwen/Control/TextBox.cs
@@ -58,10 +58,10 @@ public TextBox(Base parent, string name = "") : base(parent, name)
 
             IsTabable = true;
 
-            AddAccelerator("Ctrl + C", OnCopy);
-            AddAccelerator("Ctrl + X", OnCut);
-            AddAccelerator("Ctrl + V", OnPaste);
-            AddAccelerator("Ctrl + A", OnSelectAll);
+            AddAccelerator("CTRL+C", OnCopy);
+            AddAccelerator("CTRL+X", OnCut);
+            AddAccelerator("CTRL+V", OnPaste);
+            AddAccelerator("CTRL+A", OnSelectAll);
         }
 
         protected override bool AccelOnlyFocus => true;
diff --git a/Intersect.Client.Framework/Intersect.Client.Framework.csproj b/Intersect.Client.Framework/Intersect.Client.Framework.csproj
index 7a62cfc5..652c8fe3 100644
--- a/Intersect.Client.Framework/Intersect.Client.Framework.csproj
+++ b/Intersect.Client.Framework/Intersect.Client.Framework.csproj
@@ -36,15 +36,26 @@
     <Reference Include="JetBrains.Annotations, Version=2018.3.0.0, Culture=neutral, PublicKeyToken=1010a0d8d6380325, processorArchitecture=MSIL">
       <HintPath>..\packages\JetBrains.Annotations.2018.3.0\lib\net20\JetBrains.Annotations.dll</HintPath>
     </Reference>
+    <Reference Include="Microsoft.Extensions.DependencyInjection.Abstractions, Version=3.1.4.0, Culture=neutral, PublicKeyToken=adb9793829ddae60, processorArchitecture=MSIL">
+      <HintPath>..\packages\Microsoft.Extensions.DependencyInjection.Abstractions.3.1.4\lib\netstandard2.0\Microsoft.Extensions.DependencyInjection.Abstractions.dll</HintPath>
+    </Reference>
     <Reference Include="Newtonsoft.Json, Version=12.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed, processorArchitecture=MSIL">
       <HintPath>..\packages\Newtonsoft.Json.12.0.3\lib\net45\Newtonsoft.Json.dll</HintPath>
     </Reference>
     <Reference Include="System" />
     <Reference Include="System.Core" />
+    <Reference Include="System.Runtime.InteropServices.RuntimeInformation, Version=4.0.1.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
+      <HintPath>..\packages\System.Runtime.InteropServices.RuntimeInformation.4.3.0\lib\net45\System.Runtime.InteropServices.RuntimeInformation.dll</HintPath>
+      <Private>True</Private>
+      <Private>True</Private>
+    </Reference>
     <Reference Include="System.Xml.Linq" />
     <Reference Include="System.Data.DataSetExtensions" />
     <Reference Include="System.Data" />
     <Reference Include="System.Xml" />
+    <Reference Include="TextCopy, Version=1.0.0.0, Culture=neutral, PublicKeyToken=1ca091877d12ca03, processorArchitecture=MSIL">
+      <HintPath>..\packages\TextCopy.4.2.0\lib\net461\TextCopy.dll</HintPath>
+    </Reference>
   </ItemGroup>
   <ItemGroup>
     <Compile Include="Audio\GameAudioInstance.cs" />
diff --git a/Intersect.Client.Framework/app.config b/Intersect.Client.Framework/app.config
index 325108a9..0e69a381 100644
--- a/Intersect.Client.Framework/app.config
+++ b/Intersect.Client.Framework/app.config
@@ -4,8 +4,7 @@
   <runtime>
     <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
       <dependentAssembly>
-        <assemblyIdentity name="Microsoft.Extensions.Caching.Abstractions" publicKeyToken="adb9793829ddae60"
-                          culture="neutral" />
+        <assemblyIdentity name="Microsoft.Extensions.Caching.Abstractions" publicKeyToken="adb9793829ddae60" culture="neutral" />
         <bindingRedirect oldVersion="0.0.0.0-2.1.2.0" newVersion="2.1.2.0" />
       </dependentAssembly>
       <dependentAssembly>
@@ -17,13 +16,11 @@
         <bindingRedirect oldVersion="0.0.0.0-4.2.1.0" newVersion="4.2.1.0" />
       </dependentAssembly>
       <dependentAssembly>
-        <assemblyIdentity name="Microsoft.Extensions.Caching.Memory" publicKeyToken="adb9793829ddae60"
-                          culture="neutral" />
+        <assemblyIdentity name="Microsoft.Extensions.Caching.Memory" publicKeyToken="adb9793829ddae60" culture="neutral" />
         <bindingRedirect oldVersion="0.0.0.0-2.1.2.0" newVersion="2.1.2.0" />
       </dependentAssembly>
       <dependentAssembly>
-        <assemblyIdentity name="System.Runtime.CompilerServices.Unsafe" publicKeyToken="b03f5f7f11d50a3a"
-                          culture="neutral" />
+        <assemblyIdentity name="System.Runtime.CompilerServices.Unsafe" publicKeyToken="b03f5f7f11d50a3a" culture="neutral" />
         <bindingRedirect oldVersion="0.0.0.0-4.0.6.0" newVersion="4.0.6.0" />
       </dependentAssembly>
       <dependentAssembly>
@@ -39,18 +36,15 @@
         <bindingRedirect oldVersion="0.0.0.0-3.1.0.0" newVersion="3.1.0.0" />
       </dependentAssembly>
       <dependentAssembly>
-        <assemblyIdentity name="Microsoft.Extensions.DependencyInjection.Abstractions"
-                          publicKeyToken="adb9793829ddae60" culture="neutral" />
-        <bindingRedirect oldVersion="0.0.0.0-3.1.0.0" newVersion="3.1.0.0" />
+        <assemblyIdentity name="Microsoft.Extensions.DependencyInjection.Abstractions" publicKeyToken="adb9793829ddae60" culture="neutral" />
+        <bindingRedirect oldVersion="0.0.0.0-3.1.4.0" newVersion="3.1.4.0" />
       </dependentAssembly>
       <dependentAssembly>
-        <assemblyIdentity name="Microsoft.Extensions.Logging.Abstractions" publicKeyToken="adb9793829ddae60"
-                          culture="neutral" />
+        <assemblyIdentity name="Microsoft.Extensions.Logging.Abstractions" publicKeyToken="adb9793829ddae60" culture="neutral" />
         <bindingRedirect oldVersion="0.0.0.0-3.1.0.0" newVersion="3.1.0.0" />
       </dependentAssembly>
       <dependentAssembly>
-        <assemblyIdentity name="Microsoft.Extensions.DependencyInjection" publicKeyToken="adb9793829ddae60"
-                          culture="neutral" />
+        <assemblyIdentity name="Microsoft.Extensions.DependencyInjection" publicKeyToken="adb9793829ddae60" culture="neutral" />
         <bindingRedirect oldVersion="0.0.0.0-3.1.0.0" newVersion="3.1.0.0" />
       </dependentAssembly>
       <dependentAssembly>
@@ -70,8 +64,7 @@
         <bindingRedirect oldVersion="0.0.0.0-1.2.5.0" newVersion="1.2.5.0" />
       </dependentAssembly>
       <dependentAssembly>
-        <assemblyIdentity name="System.Diagnostics.DiagnosticSource" publicKeyToken="cc7b13ffcd2ddd51"
-                          culture="neutral" />
+        <assemblyIdentity name="System.Diagnostics.DiagnosticSource" publicKeyToken="cc7b13ffcd2ddd51" culture="neutral" />
         <bindingRedirect oldVersion="0.0.0.0-4.0.5.0" newVersion="4.0.5.0" />
       </dependentAssembly>
       <dependentAssembly>
diff --git a/Intersect.Client.Framework/packages.config b/Intersect.Client.Framework/packages.config
index 7fc7a58d..937e8f4c 100644
--- a/Intersect.Client.Framework/packages.config
+++ b/Intersect.Client.Framework/packages.config
@@ -1,6 +1,8 @@
 ï»¿<?xml version="1.0" encoding="utf-8"?>
-
 <packages>
   <package id="JetBrains.Annotations" version="2018.3.0" targetFramework="net45" />
+  <package id="Microsoft.Extensions.DependencyInjection.Abstractions" version="3.1.4" targetFramework="net461" />
   <package id="Newtonsoft.Json" version="12.0.3" targetFramework="net461" />
+  <package id="System.Runtime.InteropServices.RuntimeInformation" version="4.3.0" targetFramework="net461" />
+  <package id="TextCopy" version="4.2.0" targetFramework="net461" />
 </packages>
\ No newline at end of file
diff --git a/Intersect.Tests.Client.Framework/app.config b/Intersect.Tests.Client.Framework/app.config
index 325108a9..0e69a381 100644
--- a/Intersect.Tests.Client.Framework/app.config
+++ b/Intersect.Tests.Client.Framework/app.config
@@ -4,8 +4,7 @@
   <runtime>
     <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
       <dependentAssembly>
-        <assemblyIdentity name="Microsoft.Extensions.Caching.Abstractions" publicKeyToken="adb9793829ddae60"
-                          culture="neutral" />
+        <assemblyIdentity name="Microsoft.Extensions.Caching.Abstractions" publicKeyToken="adb9793829ddae60" culture="neutral" />
         <bindingRedirect oldVersion="0.0.0.0-2.1.2.0" newVersion="2.1.2.0" />
       </dependentAssembly>
       <dependentAssembly>
@@ -17,13 +16,11 @@
         <bindingRedirect oldVersion="0.0.0.0-4.2.1.0" newVersion="4.2.1.0" />
       </dependentAssembly>
       <dependentAssembly>
-        <assemblyIdentity name="Microsoft.Extensions.Caching.Memory" publicKeyToken="adb9793829ddae60"
-                          culture="neutral" />
+        <assemblyIdentity name="Microsoft.Extensions.Caching.Memory" publicKeyToken="adb9793829ddae60" culture="neutral" />
         <bindingRedirect oldVersion="0.0.0.0-2.1.2.0" newVersion="2.1.2.0" />
       </dependentAssembly>
       <dependentAssembly>
-        <assemblyIdentity name="System.Runtime.CompilerServices.Unsafe" publicKeyToken="b03f5f7f11d50a3a"
-                          culture="neutral" />
+        <assemblyIdentity name="System.Runtime.CompilerServices.Unsafe" publicKeyToken="b03f5f7f11d50a3a" culture="neutral" />
         <bindingRedirect oldVersion="0.0.0.0-4.0.6.0" newVersion="4.0.6.0" />
       </dependentAssembly>
       <dependentAssembly>
@@ -39,18 +36,15 @@
         <bindingRedirect oldVersion="0.0.0.0-3.1.0.0" newVersion="3.1.0.0" />
       </dependentAssembly>
       <dependentAssembly>
-        <assemblyIdentity name="Microsoft.Extensions.DependencyInjection.Abstractions"
-                          publicKeyToken="adb9793829ddae60" culture="neutral" />
-        <bindingRedirect oldVersion="0.0.0.0-3.1.0.0" newVersion="3.1.0.0" />
+        <assemblyIdentity name="Microsoft.Extensions.DependencyInjection.Abstractions" publicKeyToken="adb9793829ddae60" culture="neutral" />
+        <bindingRedirect oldVersion="0.0.0.0-3.1.4.0" newVersion="3.1.4.0" />
       </dependentAssembly>
       <dependentAssembly>
-        <assemblyIdentity name="Microsoft.Extensions.Logging.Abstractions" publicKeyToken="adb9793829ddae60"
-                          culture="neutral" />
+        <assemblyIdentity name="Microsoft.Extensions.Logging.Abstractions" publicKeyToken="adb9793829ddae60" culture="neutral" />
         <bindingRedirect oldVersion="0.0.0.0-3.1.0.0" newVersion="3.1.0.0" />
       </dependentAssembly>
       <dependentAssembly>
-        <assemblyIdentity name="Microsoft.Extensions.DependencyInjection" publicKeyToken="adb9793829ddae60"
-                          culture="neutral" />
+        <assemblyIdentity name="Microsoft.Extensions.DependencyInjection" publicKeyToken="adb9793829ddae60" culture="neutral" />
         <bindingRedirect oldVersion="0.0.0.0-3.1.0.0" newVersion="3.1.0.0" />
       </dependentAssembly>
       <dependentAssembly>
@@ -70,8 +64,7 @@
         <bindingRedirect oldVersion="0.0.0.0-1.2.5.0" newVersion="1.2.5.0" />
       </dependentAssembly>
       <dependentAssembly>
-        <assemblyIdentity name="System.Diagnostics.DiagnosticSource" publicKeyToken="cc7b13ffcd2ddd51"
-                          culture="neutral" />
+        <assemblyIdentity name="System.Diagnostics.DiagnosticSource" publicKeyToken="cc7b13ffcd2ddd51" culture="neutral" />
         <bindingRedirect oldVersion="0.0.0.0-4.0.5.0" newVersion="4.0.5.0" />
       </dependentAssembly>
       <dependentAssembly>
diff --git a/Intersect.Tests.Client/app.config b/Intersect.Tests.Client/app.config
index bf8d9c89..f50aae1e 100644
--- a/Intersect.Tests.Client/app.config
+++ b/Intersect.Tests.Client/app.config
@@ -37,7 +37,7 @@
       </dependentAssembly>
       <dependentAssembly>
         <assemblyIdentity name="Microsoft.Extensions.DependencyInjection.Abstractions" publicKeyToken="adb9793829ddae60" culture="neutral" />
-        <bindingRedirect oldVersion="0.0.0.0-3.1.0.0" newVersion="3.1.0.0" />
+        <bindingRedirect oldVersion="0.0.0.0-3.1.4.0" newVersion="3.1.4.0" />
       </dependentAssembly>
       <dependentAssembly>
         <assemblyIdentity name="Microsoft.Extensions.Logging.Abstractions" publicKeyToken="adb9793829ddae60" culture="neutral" />
-- 
2.17.1.windows.2

